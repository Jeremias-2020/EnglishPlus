<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>American English Vocabulary Simulator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .tab-active {
            background-color: #4f46e5;
            color: white;
        }
        .tab-inactive {
            background-color: white;
            color: #374151;
        }
        .tab-inactive:hover {
            background-color: #f9fafb;
        }
        .hidden {
            display: none;
        }
    </style>
</head>
<body class="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-4">
    <div class="max-w-4xl mx-auto">
        <!-- Header -->
        <div class="bg-white rounded-lg shadow-lg p-6 mb-6">
            <h1 class="text-3xl font-bold text-indigo-900 mb-2">
                üá∫üá∏ American English Vocabulary Simulator
            </h1>
            <p class="text-lg text-indigo-700 font-semibold mb-1">
                By Carlos Mario Navarro
            </p>
            <p class="text-gray-600">
                Master American English vocabulary with comprehensive explanations and pronunciation
            </p>
        </div>

        <!-- Navigation Tabs -->
        <div class="bg-white rounded-lg shadow-lg mb-6">
            <div class="flex border-b">
                <button onclick="switchTab('input')" id="tab-input" class="flex-1 px-6 py-4 font-semibold transition-colors tab-active">
                    üìö Learn New Word
                </button>
                <button onclick="switchTab('history')" id="tab-history" class="flex-1 px-6 py-4 font-semibold transition-colors tab-inactive">
                    üïí Search History
                </button>
                <button onclick="switchTab('alphabetical')" id="tab-alphabetical" class="flex-1 px-6 py-4 font-semibold transition-colors tab-inactive">
                    üî§ Alphabetical List
                </button>
            </div>

            <!-- Tab Content -->
            <div class="p-6">
                <!-- Input Tab -->
                <div id="content-input">
                    <!-- Input Section -->
                    <div class="mb-8">
                        <div class="flex gap-3">
                            <input
                                type="text"
                                id="wordInput"
                                placeholder="Enter an English word..."
                                class="flex-1 px-4 py-3 border-2 border-indigo-200 rounded-lg focus:outline-none focus:border-indigo-500 text-lg"
                                onkeypress="if(event.key === 'Enter') handleSubmit()"
                            />
                            <button
                                onclick="handleSubmit()"
                                id="learnButton"
                                class="px-8 py-3 bg-indigo-600 text-white rounded-lg font-semibold hover:bg-indigo-700 transition-colors"
                            >
                                Learn
                            </button>
                        </div>
                    </div>

                    <!-- Loading State -->
                    <div id="loadingState" class="hidden text-center py-12">
                        <div class="animate-spin rounded-full h-16 w-16 border-b-2 border-indigo-600 mx-auto mb-4"></div>
                        <p class="text-xl text-gray-600">Generating explanation...</p>
                    </div>

                    <!-- Word Display -->
                    <div id="wordDisplay" class="hidden bg-gradient-to-r from-indigo-50 to-purple-50 rounded-lg p-8 border-2 border-indigo-200">
                        <!-- Pronunciation Section -->
                        <div class="mb-6 pb-6 border-b-2 border-indigo-200">
                            <div class="flex items-center gap-4 flex-wrap">
                                <h2 id="displayWord" class="text-4xl font-bold text-indigo-900"></h2>
                                <span id="displayIPA" class="text-2xl text-indigo-600 font-mono"></span>
                                <button
                                    onclick="playCurrentAudio()"
                                    class="flex items-center gap-2 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors shadow-md"
                                    title="Play pronunciation"
                                >
                                    üîä Play Audio
                                </button>
                            </div>
                        </div>

                        <!-- Explanation -->
                        <div class="prose prose-lg max-w-none">
                            <div id="displayExplanation" class="whitespace-pre-wrap text-gray-800 leading-relaxed"></div>
                        </div>
                    </div>

                    <!-- Empty State -->
                    <div id="emptyState" class="text-center py-12 text-gray-500">
                        <div class="text-6xl mb-4 opacity-50">üìö</div>
                        <p class="text-xl">Enter a word above to begin learning!</p>
                    </div>
                </div>

                <!-- History Tab -->
                <div id="content-history" class="hidden">
                    <!-- Search Bar -->
                    <div class="mb-6">
                        <div class="relative">
                            <span class="absolute left-3 top-3 text-gray-400">üîç</span>
                            <input
                                type="text"
                                id="searchHistory"
                                placeholder="Search your vocabulary..."
                                oninput="filterHistory()"
                                class="w-full pl-10 pr-4 py-3 border-2 border-indigo-200 rounded-lg focus:outline-none focus:border-indigo-500"
                            />
                        </div>
                    </div>

                    <!-- History List -->
                    <div id="historyList" class="space-y-3"></div>
                    <div id="historyEmpty" class="hidden text-center py-12 text-gray-500">
                        <p class="text-lg">No words learned yet</p>
                    </div>
                </div>

                <!-- Alphabetical Tab -->
                <div id="content-alphabetical" class="hidden">
                    <!-- Search Bar -->
                    <div class="mb-6">
                        <div class="relative">
                            <span class="absolute left-3 top-3 text-gray-400">üîç</span>
                            <input
                                type="text"
                                id="searchAlphabetical"
                                placeholder="Search your vocabulary..."
                                oninput="filterAlphabetical()"
                                class="w-full pl-10 pr-4 py-3 border-2 border-indigo-200 rounded-lg focus:outline-none focus:border-indigo-500"
                            />
                        </div>
                    </div>

                    <!-- Alphabetical List -->
                    <div id="alphabeticalList" class="space-y-3"></div>
                    <div id="alphabeticalEmpty" class="hidden text-center py-12 text-gray-500">
                        <p class="text-lg">No words learned yet</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <div class="text-center text-gray-600 text-sm">
            <p>üéì Designed for serious learners of American English</p>
        </div>
    </div>

    <script>
        // Global state
        let history = [];
        let currentWord = null;
        let audioElement = new Audio();

        // IPA pronunciation database
        const ipaDatabase = {
            'well': 'w…õl',
            'utmost': 'Àà åtÀåmo äst',
            'important': '…™mÀàp…îÀêrt…ônt',
            'beautiful': 'ÀàbjuÀêt…™f…ôl',
            'excellent': 'Àà…õks…ôl…ônt',
            'amazing': '…ôÀàme…™z…™≈ã',
            'wonderful': 'Ààw ånd…ôrf…ôl',
            'fantastic': 'f√¶nÀàt√¶st…™k',
            'great': '…°re…™t',
            'good': '…° äd',
            'bad': 'b√¶d',
            'terrible': 'Ààt…õr…ôb…ôl',
            'awesome': 'Àà…îÀês…ôm',
            'incredible': '…™nÀàkr…õd…ôb…ôl',
            'outstanding': 'a ätÀàst√¶nd…™≈ã',
            'remarkable': 'r…™Ààm…ëÀêrk…ôb…ôl',
            'enough': '…™Ààn åf',
            'through': 'Œ∏ruÀê',
            'thought': 'Œ∏…îÀêt',
            'tough': 't åf',
            'though': '√∞o ä',
            'thorough': 'ÀàŒ∏…úÀêro ä',
            'word': 'w…úÀêrd',
            'world': 'w…úÀêrld',
            'work': 'w…úÀêrk',
            'people': 'ÀàpiÀêp…ôl',
            'about': '…ôÀàba ät',
            'because': 'b…™Ààk…îÀêz',
            'before': 'b…™Ààf…îÀêr',
            'after': 'Àà√¶ft…ôr',
            'always': 'Àà…îÀêlwe…™z',
            'never': 'Ààn…õv…ôr'
        };

        // Load history from memory
        function loadHistory() {
            const saved = localStorage.getItem('vocabHistory');
            if (saved) {
                history = JSON.parse(saved);
            }
        }

        // Save history to memory
        function saveHistory() {
            localStorage.setItem('vocabHistory', JSON.stringify(history));
        }

        // Get IPA pronunciation
        function getIPA(word) {
            return ipaDatabase[word.toLowerCase()] || 'pronunciation varies';
        }

        // Play audio
        function playAudio(text) {
            audioElement.pause();
            audioElement.currentTime = 0;
            
            // Try ResponsiveVoice API
            const audioUrl = `https://code.responsivevoice.org/getvoice.php?t=${encodeURIComponent(text)}&tl=en-US&sv=&vn=&pitch=0.5&rate=0.5&vol=1`;
            audioElement.src = audioUrl;
            audioElement.load();
            
            audioElement.play().catch(() => {
                // Fallback to Google Translate TTS
                const fallbackUrl = `https://translate.google.com/translate_tts?ie=UTF-8&q=${encodeURIComponent(text)}&tl=en&total=1&idx=0&textlen=${text.length}&client=tw-ob`;
                audioElement.src = fallbackUrl;
                audioElement.load();
                
                audioElement.play().catch(() => {
                    // Last resort: browser speech synthesis
                    const utterance = new SpeechSynthesisUtterance(text);
                    utterance.lang = 'en-US';
                    utterance.rate = 0.7;
                    utterance.pitch = 1.0;
                    utterance.volume = 1.0;
                    
                    speechSynthesis.cancel();
                    setTimeout(() => {
                        speechSynthesis.speak(utterance);
                    }, 50);
                });
            });
        }

        function playCurrentAudio() {
            if (currentWord) {
                playAudio(currentWord.word);
            }
        }

        // Generate explanation using Claude API
        async function generateExplanation(word) {
            try {
                const response = await fetch("https://api.anthropic.com/v1/messages", {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json",
                    },
                    body: JSON.stringify({
                        model: "claude-sonnet-4-20250514",
                        max_tokens: 4000,
                        messages: [{
                            role: "user",
                            content: `You are a Senior Educational Software Designer and American English linguist. 

Provide a comprehensive vocabulary explanation for the word: "${word}"

IMPORTANT: At the very beginning, provide ONLY the American English IPA pronunciation in this exact format:
IPA: /exact-ipa-here/

Then follow this EXACT structure and tone for the rest:

**Opening (warm and engaging)**
Start with "That is a fantastic word!" or similar. Then provide a brief, natural explanation of what the word means and how it's commonly used in American English.

**Word Analysis: [WORD IN CAPS]**

**English Meaning üá∫üá∏**
- Part of speech with definition
- Include multiple meanings if applicable

**Synonyms ü§ù**
- List 4-5 synonyms with brief contextual notes in parentheses

**Antonyms üö´**
- List 3-4 antonyms with brief explanations

**Common Expressions & Phrases üó£Ô∏è**
- List 3-5 common phrases or collocations with this word in quotes

**Real-World Examples üìù**
- Provide 3-4 authentic American English examples showing the word in context
- Use professional and everyday scenarios

**Visualizing [Concept] üìà** (if applicable)
- Provide a conceptual explanation or framework

**Friendly Practice (The American Way) üá∫üá∏**
- Give a practical professional usage example

**Tip Pro: [Related confusion or usage note] üí°**
- Address common mistakes or confusions

**End with an engaging practice prompt**

Write everything in American English. Be warm, professional, and pedagogically sound. Use emojis as shown above. Make it educational but friendly.`
                        }]
                    })
                });

                const data = await response.json();
                let explanation = data.content[0].text;
                
                // Extract IPA if provided
                const ipaMatch = explanation.match(/IPA:\s*\/([^\/]+)\//);
                let extractedIPA = null;
                if (ipaMatch) {
                    extractedIPA = ipaMatch[1];
                    explanation = explanation.replace(/IPA:\s*\/[^\/]+\/\s*\n*/g, '');
                }
                
                return { explanation, ipa: extractedIPA };
            } catch (error) {
                console.error('API Error:', error);
                return { 
                    explanation: generateFallbackExplanation(word), 
                    ipa: null 
                };
            }
        }

        // Fallback explanation
        function generateFallbackExplanation(word) {
            return `That is a fantastic word! "${word}" is an important term in American English that you'll encounter frequently in both professional and casual contexts.

**Word Analysis: ${word.toUpperCase()}**

**English Meaning üá∫üá∏**
This word carries significant meaning in American English communication. Understanding its proper usage will enhance your fluency and help you express yourself more precisely.

**Synonyms ü§ù**
- Related terms (context-dependent)
- Similar expressions (common usage)
- Alternative words (formal settings)

**Antonyms üö´**
- Opposite meaning (contrast)
- Contrary terms (different context)

**Common Expressions & Phrases üó£Ô∏è**
This word appears in many everyday expressions that native speakers use regularly.

**Real-World Examples üìù**
- Professional context: You'll hear this in business meetings and formal communications
- Everyday usage: Common in casual conversation with friends and colleagues
- Written form: Frequently appears in emails, reports, and articles

**Friendly Practice (The American Way) üá∫üá∏**
Try using this word in your next conversation! Americans appreciate when non-native speakers use vocabulary with confidence and precision.

**Tip Pro üí°**
Remember that context is key in American English. The same word can have different connotations depending on the situation and tone.

Practice using "${word}" in three different sentences today to build your confidence! üéØ`;
        }

        // Handle submit
        async function handleSubmit() {
            const input = document.getElementById('wordInput');
            const word = input.value.trim().toLowerCase();
            
            if (!word) return;

            // Show loading
            document.getElementById('loadingState').classList.remove('hidden');
            document.getElementById('wordDisplay').classList.add('hidden');
            document.getElementById('emptyState').classList.add('hidden');
            document.getElementById('learnButton').disabled = true;
            document.getElementById('learnButton').textContent = 'Loading...';

            // Generate explanation
            const result = await generateExplanation(word);
            const finalIPA = result.ipa || getIPA(word);

            // Create word data
            const wordData = {
                word: word,
                ipa: finalIPA,
                explanation: result.explanation,
                timestamp: new Date().toISOString()
            };

            currentWord = wordData;

            // Add to history
            history = history.filter(item => item.word !== word);
            history.unshift(wordData);
            saveHistory();

            // Display word
            displayWord(wordData);

            // Reset input
            input.value = '';
            document.getElementById('learnButton').disabled = false;
            document.getElementById('learnButton').textContent = 'Learn';
            document.getElementById('loadingState').classList.add('hidden');
        }

        // Display word
        function displayWord(wordData) {
            document.getElementById('displayWord').textContent = wordData.word;
            document.getElementById('displayIPA').textContent = `/${wordData.ipa}/`;
            document.getElementById('displayExplanation').textContent = wordData.explanation;
            document.getElementById('wordDisplay').classList.remove('hidden');
            document.getElementById('emptyState').classList.add('hidden');
        }

        // Switch tabs
        function switchTab(tab) {
            // Update tab buttons
            ['input', 'history', 'alphabetical'].forEach(t => {
                const btn = document.getElementById(`tab-${t}`);
                const content = document.getElementById(`content-${t}`);
                if (t === tab) {
                    btn.classList.add('tab-active');
                    btn.classList.remove('tab-inactive');
                    content.classList.remove('hidden');
                } else {
                    btn.classList.remove('tab-active');
                    btn.classList.add('tab-inactive');
                    content.classList.add('hidden');
                }
            });

            // Update lists
            if (tab === 'history') {
                renderHistory();
            } else if (tab === 'alphabetical') {
                renderAlphabetical();
            }
        }

        // Render history list
        function renderHistory() {
            const list = document.getElementById('historyList');
            const empty = document.getElementById('historyEmpty');
            const search = document.getElementById('searchHistory').value.toLowerCase();
            
            const filtered = history.filter(item => 
                item.word.toLowerCase().includes(search)
            );

            if (filtered.length === 0) {
                list.innerHTML = '';
                empty.classList.remove('hidden');
            } else {
                empty.classList.add('hidden');
                list.innerHTML = filtered.map((item, idx) => `
                    <button onclick="loadWord(${idx}, false)" class="w-full text-left p-4 bg-white rounded-lg border-2 border-gray-200 hover:border-indigo-400 hover:shadow-md transition-all">
                        <div class="flex items-center justify-between">
                            <div class="flex items-center gap-3">
                                <span class="text-xl font-bold text-indigo-900">${item.word}</span>
                                <span class="text-gray-600">/${item.ipa}/</span>
                            </div>
                            <span class="text-sm text-gray-500">${new Date(item.timestamp).toLocaleDateString()}</span>
                        </div>
                    </button>
                `).join('');
            }
        }

        // Render alphabetical list
        function renderAlphabetical() {
            const list = document.getElementById('alphabeticalList');
            const empty = document.getElementById('alphabeticalEmpty');
            const search = document.getElementById('searchAlphabetical').value.toLowerCase();
            
            const sorted = [...history].sort((a, b) => a.word.localeCompare(b.word));
            const filtered = sorted.filter(item => 
                item.word.toLowerCase().includes(search)
            );

            if (filtered.length === 0) {
                list.innerHTML = '';
                empty.classList.remove('hidden');
            } else {
                empty.classList.add('hidden');
                list.innerHTML = filtered.map((item) => {
                    const originalIndex = history.findIndex(h => h.word === item.word);
                    return `
                        <button onclick="loadWord(${originalIndex}, false)" class="w-full text-left p-4 bg-white rounded-lg border-2 border-gray-200 hover:border-indigo-400 hover:shadow-md transition-all">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center gap-3">
                                    <span class="text-xl font-bold text-indigo-900">${item.word}</span>
                                    <span class="text-gray-600">/${item.ipa}/</span>
                                </div>
                                <span class="text-sm text-gray-500">${new Date(item.timestamp).toLocaleDateString()}</span>
                            </div>
                        </button>
                    `;
                }).join('');
            }
        }

        // Filter history
        function filterHistory() {
            renderHistory();
        }

        // Filter alphabetical
        function filterAlphabetical() {
            renderAlphabetical();
        }

        // Load word from history
        function loadWord(index, isAlphabetical) {
            const wordData = history[index];
            currentWord = wordData;
            displayWord(wordData);
            switchTab('input');
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // Initialize
        loadHistory();
    </script>
</body>
</html>
